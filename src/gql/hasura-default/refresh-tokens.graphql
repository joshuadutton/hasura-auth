mutation insertRefreshToken($refreshToken: authRefreshTokens_insert_input!) {
  insertAuthRefreshToken(object: $refreshToken) {
    refreshToken
  }
}

mutation deleteRefreshToken($refreshTokenHash: String!) {
  deleteAuthRefreshTokens(
    where: { refreshTokenHash: { _eq: $refreshTokenHash } }
  ) {
    affectedRows: affected_rows
  }
}

mutation deleteUserRefreshTokens($userId: uuid!) {
  deleteAuthRefreshTokens(where: { user: { id: { _eq: $userId } } }) {
    affectedRows: affected_rows
  }
}

mutation deleteExpiredRefreshTokens {
  deleteAuthRefreshTokens(where: { expiresAt: { _lt: now } }) {
    affectedRows: affected_rows
  }
}
